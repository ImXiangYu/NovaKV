# 静态工厂方法

**静态工厂方法（Static Factory Method）** 是一种设计模式。简单来说：**它是一个用来创建类实例的静态公开方法，用来替代（或补充）直接使用 `new` 构造函数。**

------

### 为什么要用它？（构造函数的 3 大局限）

在 C++ 中，直接使用构造函数（Constructor）有几个很头疼的问题：

- **构造函数没有返回值**： 如果你在 `SstableReader` 的构造函数里读取文件，发现魔数不对（文件损坏），构造函数没法返回 `NULL`。你只能抛异常（在底层开发中代价很大）或者让对象处于一种“半死不活”的错误状态。
- **构造函数无法定义“有意义的名字”**： 构造函数必须和类名一样。而工厂方法可以起名字，比如 `OpenForRead()` 或 `CreateEmptyTable()`，一看就知道意图。
- **构造函数必须返回一个新对象**： 工厂方法可以更灵活。比如它可以先检查缓存，如果文件已经打开过了，就直接返回现有的指针，而不是每次都创建一个新的。